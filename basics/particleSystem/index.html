<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Particle Systems • A-Frame</title>
    <meta name="description" content="Hello, WebVR! • A-Frame">
    <script src="../../js/vendor/aframe-master.min.js"></script>
    <script src="../../js/vendor/RGBELoader.js"></script>
    <script src="../../js/vendor/PMREMGenerator.js"></script>
    <script src="../../js/systems/wireframe.js"></script>
    <script src="../../js/components/slideshow.js"></script>
    <script src="components/environment-map.js"></script>
    <script src="components/cloud.js"></script>
    <script src="components/drawcalls.js"></script>
    <script src="components/galaxy.js"></script>
    <script src="components/fireworks.js"></script>
    <script src="components/particle-system-shell.js"></script>
    <script src="components/particle-system-explosion.js"></script>
    <script src="components/particle-system-naive-wireframe.js"></script>
    <script src="components/particle-system-instanced.js"></script>
    <script src="components/particle-system-rocket-exhaust.js"></script>
  </head>
  <body>
    <a-scene
      slideshow="slides: #slide1, #slide2, #slide3, #slide4, #slide5; firstSlideIndex: 0; enabled: false; loadAlwaysFirstSlide: false"
      renderer="alpha: false; antialias: true"
      background="color: white">
      <a-assets>
        <img id="particleImage" src="assets/particle.png" />
        <img id="particleFlame" src="assets/flame.png" />
        <img id="particleFirework" src="assets/firework.png" />
        <a-asset-item id="starship" src="assets/starship.glb"></a-asset-item>
      </a-assets>
      <a-entity id="slide1">
        <div class="slide">
          <div>
            <h1>Particle System</h1>
            <p>A particle system is a technique to represent smoke, fire, rain, fireworks... Usually phenomena composed of many small discrete elements that combined appear as a single entity or follow some group dynamics.</p>

            <p>The emitter is a location where the particles are created. Usually each particle has a time counter, recycled once expired and then reemitted for good use of resources.
            </p>

            <p>
            Each particle can be rendered in multiple ways. This example renders individual <a href="http://localhost:8080/basics/quad/#0">quads</a>. This results in a drawcall per particle which is very inefficient but keeps the code simple for illustration purposes.</p>

            <p>Draw Calls: <strong id='naiveParticleSystem'>0</strong></p>
          </div>
        </div>
        <a-entity camera position="-0.40 0 1" drawcalls="target: #naiveParticleSystem"></a-entity>
        <a-entity>
          <a-entity
            particle-system-naive-wireframe="particleSize: 0.03; particleSpeed: 0.003; particleLifeTime: 5000"
            position='0 -0.5 0'></a-entity>
        </a-entity>
      </a-entity>

      <a-entity id="slide2">
        <div class="slide">
          <div>
            <h1>Particles Texture</h1>
            <p>We can apply a texture to a particle to change its appereance and simulate the desired effect.</p>

            <p>This example renders the quads using a technique called <a href="https://webglfundamentals.org/webgl/lessons/webgl-instanced-drawing.html">instanced drawing</a> to reduce the number of draw calls</p>

            <p>Draw Calls: <strong id='instancedParticleSystem'>0</strong></p>
          </div>
        </div>
         <a-entity camera position="-0.40 0 1" drawcalls="target: #instancedParticleSystem"></a-entity>
        <a-entity>
          <a-entity
            particle-system-instanced="particleSize: 0.03; src: #particleImage; particleSpeed: 0.002; particleLifeTime: 20000"
            position='0 0.2 0'></a-entity>
        </a-entity>
      </a-entity>

      <a-entity id="slide3">
        <div class="slide dark">
          <div>
            <h1>Multiple Particle Systems</h1>
            <p>We can make effects composed of multiple particle systems. In this case we have a particle system for the shells and another one for the stars. One the shell particle finishes an event triggers the start of the stars</p>
          </div>
        </div>
         <a-entity camera position="-0.40 0 1"></a-entity>
        <a-entity>
          <a-entity
            fireworks
            position='0 -0.5 0'></a-entity>
        </a-entity>
      </a-entity>

      <a-entity id="slide4" background-color="#7998ba">
        <div class="slide">
          <div>
            <h1>Particles Texture</h1>
            <p>We can apply a texture to the particles to simulate different effects</p>
          </div>
        </div>
         <a-entity camera position="-0.40 0 1"></a-entity>
        <a-entity>
          <a-entity light="type: ambient; intensity: 2.4"></a-entity>
          <a-entity light="type: directional; intensity: 0.6"></a-entity>
          <a-entity
            gltf-model="#starship"
            environment-map
            scale="0.012 0.012 0.012"></a-entity>
          <a-entity
            particle-system-rocket-exhaust="particleSize: 0.06; src: #particleFlame; particleSpeed: 0.005; particleLifeTime: 1800; color: #4768ac; endColor: #c995ea"
            particle-system-rocket-exhaust__diamond="particleSize: 0.04; src: #particleFlame; particleSpeed: 0.005; particleLifeTime: 1800; color: white; modulate: true"
            particle-system-rocket-exhaust__fire="particleSize: 0.04; src: #particleFlame; particleSpeed: 0.005; particleLifeTime: 600; color: #c9604b;"
            position='0 -0.9 0'></a-entity>
            <a-entity cloud scale="5 5 1" position="-0.6 1 -1.5"></a-entity>
            <a-entity cloud="startTime: 2000" scale="5 5 1" position="1.8 1 -1.5">
          </a-entity>
        </a-entity>
      </a-entity>

      <a-entity id="slide5">
        <div class="slide dark">
          <div>
            <h1>Complex Particle Behavior</h1>
            <p>Redefine the init and tick methods to animate the particles. A few lines of code can describe very complex behavior</p>
            <p>This is an interpretation of the <a href="https://en.wikipedia.org/wiki/Density_wave_theory">Density Wave Theory</a> that describes how the structure of spiral galaxies is formed. Notice that while the galaxy rotates the arms remain static
            <p><strong>tl:dr</strong> Arms are formed by matter rotating in overlapping concentric eliptical orbits. </p>
          </div>
        </div>
         <a-entity camera position="-0.05 0 0.125"></a-entity>
        <a-entity>
          <a-entity
            galaxy="particleSize: 0.0006; src: #particleFirework; particleSpeed: 0.002;"
            position='0 -0.5 0'></a-entity>
        </a-entity>
      </a-entity>

    </a-scene>
  </body>
</html>